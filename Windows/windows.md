### Investigating Windows

```cmd
sysinfo    #the version and year of the windows machine?
```

- When did a user(john) log onto the system last?
```cmd
net users

net users john
```
`Windows Event Logs` is a comprehensive record of the windows system and it’s applications.A windows log contains the `source of the log, date and time, user details, Event ID etc.`

Event logs can be viewed by `“Event Viewer”` comes preinstalled with Windows OS.

Event logs are mainly three types -
- `Application:` Contains the logs occurs by an application.
- `Security:` Contains the logs regarding any security events like Login, Logoff etc.
- `System:` Contains the logs generated by Operating system itself. Example: Failure of a driver.

Last logged in user details & timestamp related logged in can be found under the `Event Viewer > Security section.` Then use Event ID:`4624` as a filter to sort the logged in related logs. And use Event ID:`4672` for timestamp related information about Special privileged assigned to a new logon.

- `Event ID 4624:` An account was successfully logged in
- `Event ID 4672:` Special privileges assigned to new logo

To know about a user information like Last logged on, Local or Global group, password related information etc., we can use `“net user”` command with the username from the command prompt. Only `“net user”` command helps us to know about the available users of the system.

`Windows Task Scheduler` is a inbuilt tool that enables you to create and execute a automatically schedule any task on your system. Most of the time malware use this features to do it’s bad things on your system.

To know about the active scheduled task on system. Launch `Task Scheduler > Task Scheduler Library.` By clicking on a scheduled task from the list you will able to see more details about the scheduled task like created timestamp of the task, action or related commands of the task etc.

`Windows registry` is a type of database that contains information & settings regarding installed software and hardware of a system. `“Registry Editor”` is used to view this registry information from your system.

- `HKEY_CLASSES_ROOT:` Contain the file type, extension etc. related information.
- `HKEY_CURRENT_USER:` Contain settings of a logged in users.
- `HKEY_LOCAL_MACHINE:` Contain information about installed hardware, software and their related settings.
- `HKEY_USERS:`Contain information about the all users present on the system.
- `HKEY_CURRENT_CONFIG`: Contains the Hardware profile
- `HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Run`
    - This registry key can control the programs to run each time that a user logged on. This key is also used by malware to become persistence on the system.

`Windows hosts file` is used for maps the server or hostname to IP addresses.
In windows the location of the hosts file is `C:\Windows\System32\drivers\etc\hosts`


`Windows firewall’s Inbound Rules` defend the network against the incoming traffic. It is always helpful to save your system from malware or DDOS related attacks. It also contains the details of the port and address of the local and remote server.
Image for post

Microsoft uses IIS (Internet Informaion Services) as a default web server on the Windows. `inetpub` is the default folder situated under C:\inetpub. It contains the webserver’s content. `wwwroot` is a subfolder placed under the inetpub `(C:\inetpub\wwwroot)` holds all the content like of a webpages.